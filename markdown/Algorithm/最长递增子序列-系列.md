# ã€Œæœ€é•¿é€’å¢å­åºåˆ—ã€ç³»åˆ—

[300. æœ€é•¿é€’å¢å­åºåˆ—](https://leetcode.cn/problems/longest-increasing-subsequence/)

[2370. æœ€é•¿ç†æƒ³å­åºåˆ—](https://leetcode.cn/problems/longest-ideal-subsequence/)

[6206. æœ€é•¿é€’å¢å­åºåˆ— II](https://leetcode.cn/problems/longest-increasing-subsequence-ii/)



æœ¬å‘¨å‘¨èµ›ç¬¬å››é¢˜æ˜¯ä¸€é“ã€Œæœ€é•¿é€’å¢å­åºåˆ—ã€ï¼Œæœ¬ç¯‡æ–‡ç« æ”¶é›†äº†ä¸‰ä¸ªã€Œæœ€é•¿é€’å¢å­åºåˆ—ã€ç³»åˆ—çš„é¢˜ç›®ï¼Œä»ç®€åˆ°ç¹ï¼Œå¾ªåºæ¸è¿›ï¼ï¼

### <font color=#1FA774>æœ€é•¿é€’å¢å­åºåˆ—</font>

**é¢˜ç›®è¯¦æƒ…å¯è§ [æœ€é•¿é€’å¢å­åºåˆ—](https://leetcode.cn/problems/longest-increasing-subsequence/)**

è¿™é“é¢˜ç›®åº”è¯¥æ˜¯ã€Œæœ€é•¿é€’å¢å­åºåˆ—ã€å…¥é—¨é¢˜äº†ï¼Œä¹‹å‰ä¹Ÿæ€»ç»“è¿‡ï¼Œè¯¦æƒ…å¯è§ **[åŠ¨æ€è§„åˆ’è®¾è®¡ï¼šæœ€é•¿é€’å¢å­åºåˆ—](./åŠ¨æ€è§„åˆ’è®¾è®¡ï¼šæœ€é•¿é€’å¢å­åºåˆ—.html) ğŸ”¥ğŸ”¥ğŸ”¥**

è¿™é‡Œç›´æ¥ç»™å‡ºä»£ç ï¼š

```java
public int lengthOfLIS(int[] nums) {
    int[] dp = new int[nums.length];
    // è®°å½•æœ€ç»ˆç­”æ¡ˆï¼Œres ä¸º dp[] ä¸­çš„æœ€å¤§å€¼
    int res = 0;
    // base case
    Arrays.fill(dp, 1);
    // è‡ªåº•å‘ä¸Šä¾æ¬¡è®¡ç®— dp[i] çš„å€¼
    for (int i = 0; i < nums.length; i++) {
        // æ ¹æ®åŒºé—´ [0, i) æ¥ç¡®å®š dp[i] çš„å€¼
        for (int j = 0; j < i; j++) {
            // è¯´æ˜ nums[i] å¯ä»¥æ¥åˆ°ä»¥ nums[j] ç»“å°¾çš„å­åºåˆ—ä¸Š
            if (nums[i] > nums[j]) {
                dp[i] = Math.max(dp[i], dp[j] + 1);
            }
        }
        // å®Œæˆ dp[i] çš„è®¡ç®—
        // æ›´æ–° res
        res = Math.max(res, dp[i]);
    }
    return res;
}
```


### <font color=#1FA774>æœ€é•¿ç†æƒ³å­åºåˆ—</font>

**é¢˜ç›®è¯¦æƒ…å¯è§ [æœ€é•¿ç†æƒ³å­åºåˆ—](https://leetcode.cn/problems/longest-ideal-subsequence/)**

è¿™é“é¢˜ç›®ä¹Ÿæ˜¯æŸæ¬¡å‘¨èµ›çš„ä¸€é“é¢˜ç›®ï¼Œä¹‹å‰ä¹Ÿæ€»ç»“è¿‡ï¼Œ**è¯¦æƒ…å¯è§ [æœ€é•¿ç†æƒ³å­åºåˆ—](https://leetcode.cn/problems/longest-ideal-subsequence/solution/by-lfool-afr2/) ğŸ”¥ğŸ”¥ğŸ”¥**

è¿™é‡Œç›´æ¥ç»™å‡ºæœ€ä¼˜ä»£ç ï¼š

```java
public int longestIdealString(String s, int k) {
    int res = 0;
    int[] dp = new int[26];
    for (int i = 0; i < s.length(); i++) {
        // æŠŠå­—æ¯è½¬æ¢æˆå¯¹åº”çš„æ•°å­—ï¼Œä» 0 å¼€å§‹
        int cur = s.charAt(i) - 'a';
        for (int j = -k; j <= k; j++) {
            int t = cur + j;
            // åœ¨ [0, 26) èŒƒå›´å†…
            if (t >= 0 && t < 26) dp[cur] = Math.max(dp[cur], dp[t]);
        }
        dp[cur]++;
        res = Math.max(res, dp[cur]);
    }
    return res;
}
```

### <font color=#1FA774>æœ€é•¿é€’å¢å­åºåˆ— II</font>

**é¢˜ç›®è¯¦æƒ…å¯è§ [æœ€é•¿é€’å¢å­åºåˆ— II](https://leetcode.cn/problems/longest-increasing-subsequence-ii/)**

è¿™ä¸ªé¢˜ç›®å’Œã€Œæœ€é•¿ç†æƒ³å­åºåˆ—ã€ç®€ç›´ä¸è¦ä¸€æ¨¡ä¸€æ ·ï¼Œé™¤äº†`k`çš„èŒƒå›´å¤§äº¿ç‚¹ç‚¹

å…ˆä¸è€ƒè™‘è¶…æ—¶ï¼ŒæŒ‰ç…§ã€Œæœ€é•¿ç†æƒ³å­åºåˆ—ã€çš„æ€è·¯å†™ä¸€æ³¢

```java
public int lengthOfLIS(int[] nums, int k) {
    int ans = 0;
    // è®°å½•ä»¥ x ç»“å°¾çš„å­åºåˆ—çš„é•¿åº¦
    Map<Integer, Integer> map = new HashMap<>();
    for (int i = 0; i < nums.length; i++) {
        int cnt = 1;
        // å‘å‰æ‰¾å­åºåˆ—ç»“å°¾å€¼åœ¨èŒƒå›´ [nums[i] - k, nums[i] - 1] ä¸­çš„æœ€å¤§å€¼ 
        for (int j = 1; nums[i] - j >= 1 && j <= k; j++) {
            cnt = Math.max(cnt, map.getOrDefault(nums[i] - j, 0) + 1);
        }
        // æ›´æ–°
        map.put(nums[i], cnt);
        ans = Math.max(ans, cnt);
    }
    return ans;
}
```

æ˜¾ç„¶è¿™ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$

ç¬¬äºŒé‡å¾ªç¯åšçš„äº‹æƒ…å°±æ˜¯æ‰¾å­åºåˆ—ç»“å°¾å€¼åœ¨èŒƒå›´`[nums[i] - k, nums[i] - 1] `ä¸­çš„æœ€å¤§å€¼ï¼Œæ€ä¹ˆæ‰èƒ½ä¼˜åŒ–è¿™ä¸€ä¸ªè¿‡ç¨‹å†…ï¼ŒæŠŠæ—¶é—´å¤æ‚åº¦ä» $O(n)$ é™ä½åˆ° $O(logn)$

ç­”æ¡ˆå°±æ˜¯çº¿æ®µæ ‘ï¼Œ**å…³äºçº¿æ®µæ ‘çš„è¯¦è§£å¯è§ [çº¿æ®µæ ‘è¯¦è§£](./çº¿æ®µæ ‘è¯¦è§£.html) ğŸ”¥ğŸ”¥ğŸ”¥**

å‘ç°æ˜¯ç”¨çº¿æ®µæ ‘è§£å†³ï¼Œé‚£ä¹ˆå°±æ˜¯ç›´æ¥å¥—æ¨¡ç‰ˆäº†ï¼Œå»ºè®®ä»”ç»†é˜…è¯»ã€Œçº¿æ®µæ ‘è¯¦è§£ã€ï¼Œç›¸ä¿¡ä¼šæœ‰ä¸ä¸€æ ·çš„æ”¶è·

è¿™é‡Œæ˜¯**ã€ŒåŒºé—´æœ€å€¼ã€**ä¸”**å¯¹åŒºé—´è¿›è¡Œã€Œè¦†ç›–ã€çš„æ›´æ–°æ“ä½œ**ç±»å‹ï¼Œä¸‹é¢ç»™å‡ºä»£ç ï¼š

```java
class Solution {
    public int lengthOfLIS(int[] nums, int k) {
        int ans = 0;
        Map<Integer, Integer> map = new HashMap<>();
        for (int i = 0; i < nums.length; i++) {
            // æŸ¥è¯¢åŒºé—´ [nums[i] - k, nums[i] - 1] çš„æœ€å€¼
            int cnt = query(root, 0, N, Math.max(0, nums[i] - k), nums[i] - 1) + 1;
            // æ›´æ–°ï¼Œæ³¨æ„è¿™é‡Œæ˜¯è¦†ç›–æ›´æ–°ï¼Œå¯¹åº”çš„æ¨¡ç‰ˆä¸­è¦†ç›–æ›´æ–°ä¸éœ€è¦ç´¯åŠ ï¼Œå·²åœ¨ä¸‹æ–¹ä»£ç ä¸­æ ‡æ³¨
            update(root, 0, N, nums[i], nums[i], cnt);
            ans = Math.max(ans, cnt);
        }
        return ans;
    }
    // *************** ä¸‹é¢æ˜¯æ¨¡ç‰ˆ ***************
    class Node {
        Node left, right;
        int val, add;
    }
    private int N = (int) 1e5;
    private Node root = new Node();
    public void update(Node node, int start, int end, int l, int r, int val) {
        if (l <= start && end <= r) {
            node.val = val; // ä¸éœ€è¦ç´¯åŠ 
            node.add = val; // ä¸éœ€è¦ç´¯åŠ 
            return ;
        }
        pushDown(node);
        int mid = (start + end) >> 1;
        if (l <= mid) update(node.left, start, mid, l, r, val);
        if (r > mid) update(node.right, mid + 1, end, l, r, val);
        pushUp(node);
    }
    public int query(Node node, int start, int end, int l, int r) {
        if (l <= start && end <= r) return node.val;
        pushDown(node);
        int mid = (start + end) >> 1, ans = 0;
        if (l <= mid) ans = query(node.left, start, mid, l, r);
        if (r > mid) ans = Math.max(ans, query(node.right, mid + 1, end, l, r));
        return ans;
    }
    private void pushUp(Node node) {
        node.val = Math.max(node.left.val, node.right.val);
    }
    private void pushDown(Node node) {
        if (node.left == null) node.left = new Node();
        if (node.right == null) node.right = new Node();
        if (node.add == 0) return ;
        node.left.val = node.add;  // ä¸éœ€è¦ç´¯åŠ 
        node.right.val = node.add; // ä¸éœ€è¦ç´¯åŠ 
        node.left.add = node.add;  // ä¸éœ€è¦ç´¯åŠ 
        node.right.add = node.add; // ä¸éœ€è¦ç´¯åŠ 
        node.add = 0;
    }
}
```
