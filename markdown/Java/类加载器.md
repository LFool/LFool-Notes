**<font color='red'>ã€ŒJVM ç±»åŠ è½½å­ç³»ç»Ÿã€ç³»åˆ—æ–‡ç« </font>**

- **[ç±»åŠ è½½çš„è¿‡ç¨‹](./ç±»åŠ è½½çš„è¿‡ç¨‹.html)**
- **[ç±»åŠ è½½çš„æ—¶æœº](./ç±»åŠ è½½çš„æ—¶æœº.html)**
- **[â¤ï¸â€ğŸ”¥ ç±»åŠ è½½å™¨](./ç±»åŠ è½½å™¨.html)**
- **[å‰–æ [Bootstrapã€Extensionã€Application] ClassLoader](./å‰–æ-Bootstrap-Extension-Application-ClassLoader.html)**
- **[åŒäº²å§”æ´¾æ¨¡å‹](./åŒäº²å§”æ´¾æ¨¡å‹.html)**
- **[è‡ªå®šä¹‰ç±»åŠ è½½å™¨](./è‡ªå®šä¹‰ç±»åŠ è½½å™¨.html)**
- **[ç ´ååŒäº²å§”æ´¾æ¨¡å‹](./ç ´ååŒäº²å§”æ´¾æ¨¡å‹.html)**

# ç±»åŠ è½½å™¨

åŠ è½½é˜¶æ®µéœ€è¦å®Œæˆçš„ä¸€ä¸ªæ ¸å¿ƒä»»åŠ¡ï¼šã€Œé€šè¿‡ä¸€ä¸ªç±»çš„**å…¨é™å®šå**æ¥è·å–å®šä¹‰æ­¤ç±»çš„**äºŒè¿›åˆ¶å­—èŠ‚æµ**ã€

Java è™šæ‹Ÿæœºè®¾è®¡å›¢é˜Ÿæœ‰æ„å°†è¿™ä¸€ä»»åŠ¡æ”¾åˆ° Java è™šæ‹Ÿæœºå¤–éƒ¨ï¼Œä»¥ä¾¿è®©åº”ç”¨ç¨‹åºè‡ªå·±å»å†³å®šå¦‚ä½•è·å–æ‰€éœ€çš„ç±»

å®ç°è¿™ä¸ªä»»åŠ¡çš„ä»£ç å°±è¢«ä½œï¼š**ç±»åŠ è½½å™¨**

### <font color=#1FA774>ç±»çš„å”¯ä¸€æ€§</font>

ç±»åŠ è½½å™¨è™½ç„¶åªç”¨äºå®Œæˆå®ç°ç±»çš„åŠ è½½åŠ¨ä½œï¼Œä½†å®ƒåœ¨ Java ç¨‹åºä¸­èµ·åˆ°çš„ä½œç”¨å´è¿œè¶…ç±»åŠ è½½é˜¶æ®µ

æ¯ä¸ª Class å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªæ–¹æ³•ï¼š`getClassLoader()`ã€‚é¡¾åæ€ä¹‰ï¼Œè·å–åŠ è½½è¯¥ Class å¯¹è±¡çš„ç±»åŠ è½½å™¨

**å¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½å¿…é¡»ç”±å®ƒçš„<font color='red'>ç±»åŠ è½½å™¨</font>å’Œè¿™ä¸ª<font color='red'>ç±»æœ¬èº«</font>ä¸€èµ·å…±åŒç¡®å®šå®ƒåœ¨ Java è™šæ‹Ÿæœºä¸­çš„å”¯ä¸€æ€§**

æ›´é€šä¿—ä¸€ç‚¹ï¼šæ¯”è¾ƒä¸¤ä¸ªç±»æ˜¯å¦ã€Œç›¸ç­‰ã€ï¼Œåªæœ‰åœ¨è¿™ä¸¤ä¸ªç±»æ˜¯ç”±åŒä¸€ä¸ªç±»åŠ è½½å™¨åŠ è½½çš„å‰æä¸‹æ‰æœ‰æ„ä¹‰ï¼›å¦åˆ™ï¼Œå³ä½¿è¿™ä¸¤ä¸ªç±»æ¥æºåŒä¸€ä¸ª Class æ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ª Java è™šæ‹ŸæœºåŠ è½½ï¼Œåªè¦åŠ è½½å®ƒä»¬çš„ç±»åŠ è½½å™¨ä¸åŒï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç±»å°±å¿…å®šä¸ç›¸ç­‰

### <font color=#1FA774>ç±»åŠ è½½å™¨çš„åˆ†ç±»</font>

**ä» Java è™šæ‹Ÿæœºçš„è§’åº¦**ï¼Œåªæœ‰ä¸¤ç§ä¸åŒçš„ç±»åŠ è½½å™¨ï¼š

- **å¯åŠ¨ç±»åŠ è½½å™¨ (Bootstrap ClassLoader)**ï¼šC++ å®ç°ï¼Œæ˜¯è™šæ‹Ÿæœºè‡ªèº«çš„ä¸€éƒ¨åˆ†
- **å…¶å®ƒæ‰€æœ‰çš„ç±»åŠ è½½å™¨**ï¼šJava å®ç°ï¼Œç‹¬ç«‹å­˜åœ¨äºè™šæ‹Ÿæœºå¤–éƒ¨ï¼Œå¹¶å…¨éƒ¨ç»§æ‰¿è‡ªæŠ½è±¡ç±»`java.lang.ClassLoader`

**ä» Java å¼€å‘äººå‘˜çš„è§’åº¦**ï¼Œç±»åŠ è½½å™¨çš„åˆ’åˆ†æ›´ç»†è‡´ä¸€äº›ï¼š

- **å¯åŠ¨ç±»åŠ è½½å™¨ (Bootstrap ClassLoader)**ï¼šè´Ÿè´£åŠ è½½å­˜æ”¾åœ¨`<JAVA_HOME>/lib`ç›®å½•ï¼Œæˆ–è€…è¢«`-Xbootclasspath`å‚æ•°æ‰€æŒ‡å®šçš„è·¯å¾„ä¸­å­˜æ”¾çš„ï¼Œè€Œä¸”å¯ä»¥è¢« JVM è¯†åˆ«çš„ç±»åº“åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­
    - æŒ‰ç…§æ–‡ä»¶åè¯†åˆ«ï¼Œå¦‚ï¼š`rt.jar`ã€`tools.jar`ï¼Œåå­—ä¸ç¬¦åˆçš„ç±»åº“å³ä½¿æ”¾åœ¨`lib`ç›®å½•ä¸­ä¹Ÿä¸ä¼šè¢«åŠ è½½
- **æ‰©å±•ç±»åŠ è½½å™¨ (Extension ClassLoader)**ï¼šè´Ÿè´£åŠ è½½å­˜æ”¾åœ¨`<JAVA_HOME>/lib/ext`ç›®å½•ï¼Œæˆ–è€…è¢«`java.ext.dirs`ç³»ç»Ÿå˜é‡æ‰€æŒ‡å®šçš„è·¯å¾„ä¸­æ‰€æœ‰çš„ç±»åº“
    - è¯¥ç±»åŠ è½½å™¨æ˜¯åœ¨`sun.misc.Launcher$ExtClassLoader`ä¸­ä»¥ Java ä»£ç çš„å½¢å¼å®ç°
- **åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ (Application ClassLoader)**ï¼šè´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ (ClassPath) ä¸Šæ‰€æœ‰çš„ç±»åº“
    - ã€Œåº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ã€ä¹Ÿå¯ç§°ä¸ºã€Œç³»ç»Ÿç±»åŠ è½½å™¨ã€
    - è¯¥ç±»åŠ è½½å™¨æ˜¯åœ¨`sun.misc.Launcher$ClassLoader`ä¸­ä»¥ Java ä»£ç çš„å½¢å¼å®ç°
    - å¦‚æœåº”ç”¨ä¸­æ²¡æœ‰è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨çš„å°±æ˜¯è¿™ä¸ªé»˜è®¤çš„ç±»åŠ è½½å™¨

å®ƒä»¬ä¸‰è€…çš„å…³ç³»å¦‚ä¸‹ï¼š(å¢åŠ äº†ä¸€ä¸ªè‡ªå®šä¹‰ç±»åŠ è½½å™¨)

![4](https://cdn.jsdelivr.net/gh/LFool/image-hosting@master/20221024/2214481666620888l8TrcT4.svg)

```java
public static void main(String[] args) {
    ClassLoader systemClassLoader = ClassLoader.getSystemClassLoader();
    System.out.println(systemClassLoader);
    System.out.println(systemClassLoader.getParent());
    System.out.println(systemClassLoader.getParent().getParent());
}
// result
sun.misc.Launcher$AppClassLoader@18b4aac2
sun.misc.Launcher$ExtClassLoader@6bc7c054
null
```

ç”±äºå¯åŠ¨ç±»åŠ è½½å™¨æ˜¯ç”± C++ å®ç°ï¼Œæ‰€ä»¥åªä¼šè¾“å‡ºä¸€ä¸ª`null`

**<font color='red'>å…³äºä¸‰è€…çš„æºç åˆ†æå¯è§ [å‰–æ [Bootstrapã€Extensionã€Application] ClassLoader](./å‰–æ-Bootstrap-Extension-Application-ClassLoader.html)</font>**

ä¸‹é¢å¯ä»¥æ›´å…·ä½“çš„è¾“å‡ºä¸€ä¸‹æ¯ä¸ªç±»åŠ è½½å™¨åŠ è½½çš„ç±»åº“ 

```java
public static void main(String[] args) {
    System.out.println("---- å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½çš„æ–‡ä»¶ ----");
    URL[] urLs = Launcher.getBootstrapClassPath().getURLs();
    for (URL urL : urLs) {
        System.out.println(urL);
    }
    System.out.println("---- æ‰©å±•ç±»åŠ è½½å™¨åŠ è½½çš„æ–‡ä»¶ ----");
    System.out.println(System.getProperty("java.ext.dirs"));
    System.out.println("---- åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨åŠ è½½çš„æ–‡ä»¶ ----");
    System.out.println(System.getProperty("java.class.path"));
}

---- å¯åŠ¨ç±»åŠ è½½å™¨åŠ è½½çš„æ–‡ä»¶ ----
file:/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/resources.jar
file:/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/rt.jar
file:/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/sunrsasign.jar
file:/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/jsse.jar
file:/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/jce.jar
file:/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/charsets.jar
file:/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/jfr.jar
file:/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/cat.jar
file:/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/classes
---- æ‰©å±•ç±»åŠ è½½å™¨åŠ è½½çš„æ–‡ä»¶ ----
/Users/lfool/Library/Java/Extensions:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext:
/Library/Java/Extensions:
/Network/Library/Java/Extensions:
/System/Library/Java/Extensions:
/usr/lib/java
---- åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨åŠ è½½çš„æ–‡ä»¶ ----
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/cat.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/charsets.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/cldrdata.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/crs-agent.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/dnsns.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/jaccess.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/legacy8ujsse.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/localedata.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/nashorn.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/openjsse.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/sunec.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/sunjce_provider.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/sunpkcs11.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/ext/zipfs.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/jce.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/jfr.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/jsse.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/management-agent.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/resources.jar:
/Library/Java/JavaVirtualMachines/zulu-8.jdk/Contents/Home/jre/lib/rt.jar:
/Users/lfool/myself/IdeaProjects/concurrency/target/classes:
/Applications/IntelliJ IDEA.app/Contents/lib/idea_rt.jar